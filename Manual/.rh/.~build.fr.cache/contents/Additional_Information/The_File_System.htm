 Le système de fichiers Lorsque vous utilisez les fonctions du système de fichiers ou les fichiers inclus avec GameMaker Studio 2 il est extrêmement important de savoir exactement comment le système de fichiers fonctionne et ce qui se passe dans les coulisses. À cette fin, cette section est conçue pour expliquer et clarifier exactement comment les choses sont stockées, où elles sont stockées et quelles sont les limites ou les solutions de contournement possibles de ce système. La première et la plus importante chose à noter à propos des fonctions de fichiers est qu'elles sont limitées - en général et par défaut - au bac à sable. Cela signifie que GameMaker Studio 2 ne peut pas enregistrer ou charger des fichiers de n'importe où qui ne fait pas partie du bundle de jeu ou du stockage local de l'appareil sans entrée explicite de l'utilisateur, et même dans ce cas, cette entrée est limitée uniquement à Windows, macOS et Plates-formes cibles Ubuntu ( Linux IMPORTANT! Il est toutefois possible de désactiver le sandboxing sur les cibles Desktop ( Windows, macOS et Ubuntu ( Linux )) en cochant l' option Désactiver le sandbox du système de fichiers dans les Options de jeu de la plate-forme cible. Vous le faites à vos risques et périls, et bien que cela ouvrira l'enregistrement et le chargement de fichiers et vous permettra d'accéder aux fichiers n'importe où sur le système donné, cela peut toujours être limité par les autorisations du système d'exploitation, et vous ne pourrez pas écrire sur le program_directory dossier. Pour comprendre le bac à sable, vous devez tout d'abord comprendre qu'il existe deux zones distinctes pour les fichiers: L'ensemble de fichiers - c'est là que tous les fichiers qui sont fournis avec le jeu exécutable sont stockés, y compris les fichiers que vous avez ajoutés à la liste d'actifs Fichiers inclus à GameMaker Studio 2 (qui sont les fichiers externes avec lesquels vous voulez empaqueter le jeu). La zone de sauvegarde - c'est une zone de stockage de l'appareil sur laquelle le jeu peut écrire en toute sécurité et le jeu est garanti qu'il s'agit d'une zone inscriptible. Le diagramme suivant peut vous aider à mieux visualiser cela: REMARQUE: vous ne pouvez jamais écrire dans le répertoire File Bundle (programme). Lorsque votre jeu est en bac à sable, les deux zones cibles - le répertoire du bundle et la zone de stockage local - sont disponibles sur chaque plate-forme cible, mais sur chacune d'elles, elles fonctionneront légèrement différemment. Cependant, GameMaker Studio 2 a résumé l'essence principale de ce qui peut et ne peut pas être fait, ce qui facilite le reciblage des jeux vers plusieurs environnements. Pour commencer, vous devez comprendre ce que cela signifie lorsque nous parlons de working_directory. Ceci est un synonyme des deux emplacements de sauvegarde possibles (comme illustré par le diagramme ci-dessus) et lorsque vous utilisez ce répertoire, il fera l'une des deux choses selon que vous lisez ou écrivez, et si le fichier que vous lisez a été changé ou non: Opérations de lecture - working_directory vérifiera d'abord la zone de sauvegarde pour voir si le fichier auquel on accède est là, et s'il l'utilise. Cependant, si le fichier n'existe pas dans la zone de sauvegarde, il vérifie alors la zone de regroupement de fichiers et l'utilise (si le fichier recherché est un fichier inclus avec votre jeu). Opérations d'écriture - Cela ne peut se produire que dans la zone de sauvegarde. REMARQUE: en général, GameMaker Studio 2 gérera tout cela pour vous et vous aurez rarement besoin d'utiliser la variable intégrée working_directory. En utilisant ces deux règles simples, nous pouvons maintenant voir comment fonctionnent les fonctions suivantes (ce sont des exemples pour vous aider à visualiser le processus pour les différentes fonctions disponibles): directory_create() (et les autres fonctions de répertoire) ne fonctionneront que dans la zone de sauvegarde. les fonctions du système de fichiers renvoie des informations sur les fichiers à la fois le faisceau et la zone de sauvegarde, mais ils n'écrire à la zone de sauvegarde. les fonctions d'écriture de texte, binaire ou INI Les fichiers créeront un nouveau fichier dans la zone de sauvegarde s'il n'en existe pas déjà un, en copiant toutes les informations des fichiers originaux inclus avec le kit de jeu s'ils existent. Notez que les fichiers d'origine resteront toujours dans la partie en lecture seule du répertoire de sauvegarde, mais ils ne seront pas référencés tant qu'une version existe dans la section lecture / écriture de la zone de sauvegarde. Sur les Windows, macOS et Ubuntu ( Linux ), il existe deux façons d'enregistrer et de charger des fichiers depuis l'extérieur du bac à sable, soit en utilisant les fonctions get_open_filename() et get_save_filename() (ces deux fonctions nécessiteront que l'utilisateur sélectionne une zone de chargement et d'enregistrement et la chaîne de retour peut ensuite être utilisée dans le reste des fonctions de fichier pour contourner le bac à sable - voir les descriptions des fonctions dans la section langue du manuel pour plus des détails). L'autre moyen consiste à désactiver complètement le bac à sable à partir des options de jeu pour la plate-forme cible (disponible uniquement pour les cibles Desktop, comme indiqué plus haut sur cette page). Sur HTML5, il est également possible de charger des fichiers depuis l'extérieur du bac à sable depuis un serveur, mais cela ne doit être fait qu'en utilisant la fonction buffer_load_async() car le chargement synchrone est obsolète sur la plupart des navigateurs et sera finalement obsolète. Cela signifie que les fichiers chargés de cette manière doivent être enregistrés en tant que fichiers binaires - par exemple, vous pouvez enregistrer un fichier *.ini comme une chaîne (voir ini_close() pour plus de détails), puis écrivez-le dans un tampon qui peut ensuite être enregistré et chargé à l'aide des fonctions asynchrones. Notez que si vous chargez des images à l'aide de sprite_add() alors ceux-ci sont déjà traités de manière asynchrone. Vous devez également savoir que chaque plate-forme cible a sa propre zone de sauvegarde dans laquelle les fichiers et les répertoires peuvent être écrits et lus. Vous trouverez ci-dessous une liste de ces zones pour chaque cible une fois en bac à sable: Windows et Windows UWP: Windows a tous les fichiers dans le %localappdata%\<Game Name> répertoire (sous Windows 7 il s'agit du /Users/<User Name>/AppData/Local/<Game Name> annuaire). HTML5: Tout se fait via le stockage local. macOS: le stockage dépendra du fait que l'application soit en bac à sable ou non (selon les règles d'Apple, le chemin étant généralement ~/Library/Application Support/<Game Name> ). Ubuntu ( Linux ): les fichiers sont stockés dans le Home/.config/gamename où "Home" est le répertoire de base des utilisateurs - /home/<username> iOS / tvOS: le stockage est l'emplacement standard (tel qu'il est affiché via iTunes). Android: les fichiers sont à l'emplacement standard (qui est invisible sauf si l'appareil est enraciné) /data/<package name>. Il est à noter que le module cible HTML5 a une limite de stockage local (qui peut être comprise entre 1 Mo et 5 Mo selon le navigateur), ce qui signifie que vous ne serez pas autorisé à enregistrer de grands sprites, des captures d'écran, etc.  Retour: Informations complémentaires Suivant: Opérateurs binaires et binaires © Copyright YoYo Games Ltd. 2021 Tous droits réservés
  
  
  

